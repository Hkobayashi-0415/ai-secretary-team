# Phase 7: UI/UX設計書 - プラン承認画面設計

## 1. 設計概要

### 1.1 設計目的
統合版プラットフォームのプラン承認画面において、AI秘書が提案するプランの提出・承認・却下・修正要求を効率的に行い、チーム全体のプラン承認プロセスを透明性・追跡性・効率性を重視した直感的なインターフェースを設計する。

### 1.2 画面の役割
- **プラン提出**: AI秘書からのプラン提案・詳細情報の表示
- **承認ワークフロー**: 承認者・却下・修正要求・条件付き承認
- **進捗追跡**: プランの承認状況・履歴・タイムライン
- **コラボレーション**: 関係者間のコメント・議論・合意形成
- **分析・レポート**: 承認率・処理時間・傾向分析

### 1.3 対象ユーザー
- **プライマリ**: プロジェクトマネージャー・承認者・ステークホルダー
- **セカンダリ**: AI秘書・チームリーダー・品質管理者
- **一般ユーザー**: プラン提案者・関係者・監査担当者

## 2. 画面構成設計

### 2.1 全体レイアウト
**画面構造**:
```
┌─────────────────────────────────────────────────────────┐
│ ヘッダーナビゲーション (64px)                          │
├─────────────────┬───────────────────────────────────────┤
│ サイドバー      │ メインコンテンツエリア                │
│ ナビゲーション  │                                      │
│ (280px)        │  ┌─────────────────────────────────┐ │
│                 │  │ ブレッドクラム (40px)           │ │
│                 │  ├─────────────────────────────────┤ │
│                 │  │ プラン承認コンテンツ            │ │
│                 │  │                                 │ │
│                 │  │ ┌─────────┐ ┌─────────┐        │ │
│                 │  │ │フィルター│ │新規     │        │ │
│                 │  │ │・検索   │ │プラン   │        │ │
│                 │  │ └─────────┘ └─────────┘        │ │
│                 │  │                                 │ │
│                 │  │ ┌─────────────────────────────┐ │ │
│                 │  │ │ プラン一覧表示エリア        │ │ │
│                 │  │ │ (テーブル・カード・タイムライン)│ │
│                 │  │ └─────────────────────────────┘ │ │
│                 │  │                                 │ │
│                 │  │ ┌─────────────────────────────┐ │ │
│                 │  │ │ プラン詳細・承認パネル      │ │ │
│                 │  │ └─────────────────────────────┘ │ │
│                 │  └─────────────────────────────────┘ │
└─────────────────┴───────────────────────────────────────┘
```

### 2.2 レイアウト詳細
**ヘッダーナビゲーション**:
- 高さ: 64px
- 内容: ロゴ・タイトル・ユーザー情報・通知・設定

**サイドバーナビゲーション**:
- 幅: 280px
- 内容: メニュー項目・現在位置・サブメニュー

**メインコンテンツエリア**:
- 幅: 可変（レスポンシブ対応）
- 内容: ブレッドクラム・フィルター・検索・プラン一覧・詳細パネル

## 3. コンポーネント設計

### 3.1 フィルター・検索エリア
**検索バー**:
- 幅: 100% (最大600px)
- 高さ: 48px
- 機能: リアルタイム検索・プランタイトル・提案者・内容での検索
- プレースホルダー: "プランタイトル、提案者、内容で検索..."

**フィルター**:
- 表示形式: ドロップダウン・チェックボックス・スライダー
- フィルター項目:
  - ステータス（下書き・提出済み・承認済み・却下・修正要求）
  - 優先度（低・中・高・緊急）
  - 提案者（AI秘書・ユーザー・チーム）
  - カテゴリ（開発・デザイン・マーケティング・営業・管理）
  - 期間（作成日・提出日・承認日）
  - 承認者（担当者・未割り当て）

**表示切替ボタン**:
- テーブル表示: 詳細情報を含む表形式表示
- カード表示: 視覚的に分かりやすいカード形式
- タイムライン表示: 時系列での進捗表示

### 3.2 プラン一覧表示エリア

#### 3.2.1 テーブル表示
**テーブルレイアウト**:
- 行の高さ: 72px
- 列構成:
  - ステータスインジケーター (48px × 48px)
  - プランタイトル
  - 提案者（AI秘書アイコン・名前）
  - 優先度
  - カテゴリ
  - 提出日
  - 承認者
  - 期限
  - アクション

**テーブル機能**:
- ソート: 各列での昇順・降順ソート
- 選択: 複数選択・一括操作
- ページネーション: 20件/ページ
- 行展開: 詳細情報のインライン表示

#### 3.2.2 カード表示
**カードレイアウト**:
- カードサイズ: 320px × 280px
- グリッド: レスポンシブ対応（1-4列）
- カード内容:
  - ステータスバッジ (上部)
  - プランタイトル (最大30文字)
  - 提案者情報 (アイコン・名前・役割)
  - 優先度インジケーター
  - カテゴリタグ
  - 提出日・期限
  - 承認者・承認状況
  - 簡単な説明 (最大100文字)

**カードインタラクション**:
- ホバー: 影の強調・詳細情報のプレビュー
- クリック: 詳細パネルの表示
- 右クリック: コンテキストメニュー（承認・却下・修正要求）

#### 3.2.3 タイムライン表示
**タイムラインレイアウト**:
- 表示形式: 縦型タイムライン・横型ガントチャート
- 時間軸: 日・週・月・四半期
- プラン表示: 期間・ステータス・進捗状況
- 依存関係: プラン間の関連性・順序

### 3.3 プラン詳細・承認パネル
**パネル構成**:
- 幅: 500px
- 高さ: 100vh
- 表示位置: 右側（スライドイン）

**タブ構成**:
1. **概要タブ**:
   - プラン基本情報
   - 提案者詳細
   - ステータス・進捗
   - 承認履歴

2. **詳細タブ**:
   - 目的・背景
   - スコープ・範囲
   - タイムライン・マイルストーン
   - リソース・コスト

3. **承認タブ**:
   - 承認・却下・修正要求
   - コメント・フィードバック
   - 条件・制約
   - 承認者割り当て

4. **議論タブ**:
   - コメント・質問
   - 議論履歴
   - 合意形成
   - 決定事項

## 4. 承認ワークフロー設計

### 4.1 承認フロー
**基本フロー**:
1. **プラン提出**: AI秘書・ユーザーからのプラン提案
2. **初期レビュー**: 自動チェック・形式確認
3. **承認者割り当て**: 適切な承認者の自動・手動割り当て
4. **レビュー・承認**: 承認者の詳細レビュー・決定
5. **通知・実行**: 関係者への通知・プラン実行開始

**承認パターン**:
- **単一承認**: 1人の承認者による承認
- **複数承認**: 複数承認者の順次・並行承認
- **条件付き承認**: 条件満足後の承認
- **委任承認**: 承認権限の委任・代理承認

### 4.2 承認アクション
**承認**:
- アクション: 承認ボタン・承認理由・条件
- 結果: ステータス変更・実行開始・通知送信
- 履歴: 承認者・承認日時・承認理由の記録

**却下**:
- アクション: 却下ボタン・却下理由・改善提案
- 結果: ステータス変更・提案者への通知・再提出依頼
- 履歴: 却下者・却下日時・却下理由の記録

**修正要求**:
- アクション: 修正要求ボタン・修正内容・期限
- 結果: ステータス変更・修正依頼・再レビュー待ち
- 履歴: 要求者・要求日時・修正内容の記録

### 4.3 承認者管理
**承認者割り当て**:
- **自動割り当て**: ルールベース・AI推奨による自動割り当て
- **手動割り当て**: 管理者による手動割り当て
- **委任設定**: 承認権限の委任・代理設定

**承認権限**:
- **完全承認**: 最終決定権を持つ承認者
- **部分承認**: 特定範囲の承認権限
- **諮問承認**: 意見・助言のみ（決定権なし）

## 5. ステータス管理設計

### 5.1 プランステータス
**基本ステータス**:
- **下書き**: 作成中・編集可能
- **提出済み**: レビュー待ち・承認待ち
- **レビュー中**: 承認者によるレビュー中
- **承認済み**: 承認完了・実行可能
- **却下**: 承認拒否・再提出必要
- **修正要求**: 修正・再提出待ち
- **実行中**: プラン実行中
- **完了**: プラン完了
- **キャンセル**: プラン中止

**ステータス遷移**:
```
下書き → 提出済み → レビュー中 → 承認済み → 実行中 → 完了
                ↓         ↓         ↓
             却下    修正要求    キャンセル
```

### 5.2 進捗追跡
**進捗インジケーター**:
- **プログレスバー**: 全体進捗の視覚的表示
- **ステップ表示**: 各段階の完了状況
- **タイムライン**: 予定・実績の比較表示
- **マイルストーン**: 重要な節目の達成状況

**遅延・リスク管理**:
- **期限管理**: 提出期限・承認期限・実行期限
- **アラート**: 期限切れ・遅延の警告
- **エスカレーション**: 遅延時の自動通知・昇格

## 6. コラボレーション機能設計

### 6.1 コメント・議論
**コメント機能**:
- **インラインコメント**: 特定部分への直接コメント
- **スレッドコメント**: 議論の流れを保持
- **@メンション**: 特定ユーザーへの通知
- **リアクション**: いいね・賛成・反対等の感情表現

**議論管理**:
- **議論スレッド**: トピック別の議論整理
- **合意形成**: 投票・合意状況の可視化
- **決定事項**: 議論結果・決定内容の記録
- **アクションアイテム**: 次のアクション・担当者の明確化

### 6.2 通知・アラート
**通知タイプ**:
- **承認要求**: 承認者への承認依頼通知
- **ステータス変更**: 関係者への状況変更通知
- **期限切れ**: 期限切れ・遅延の警告通知
- **コメント**: 新しいコメント・返信の通知

**通知方法**:
- **インアプリ**: アプリ内通知・バッジ表示
- **メール**: 重要度に応じたメール通知
- **プッシュ通知**: モバイル・デスクトップ通知
- **Slack/Teams**: 外部ツール連携通知

## 7. 分析・レポート機能設計

### 7.1 承認分析
**承認メトリクス**:
- **承認率**: 全体・カテゴリ別・承認者別の承認率
- **処理時間**: 提出から承認までの平均時間
- **却下率**: 却下されたプランの割合・理由分析
- **修正要求率**: 修正要求の頻度・内容分析

**傾向分析**:
- **時系列分析**: 月別・四半期別の傾向
- **カテゴリ分析**: 分野別の承認パターン
- **承認者分析**: 承認者別の処理傾向・基準
- **季節性分析**: 時期による承認パターンの変化

### 7.2 レポート生成
**レポートタイプ**:
- **定期レポート**: 日次・週次・月次レポート
- **承認者レポート**: 承認者別の処理状況
- **カテゴリレポート**: 分野別の承認状況
- **カスタムレポート**: ユーザー定義レポート

**レポート形式**:
- **ダッシュボード**: リアルタイム・インタラクティブ表示
- **PDF/Excel**: 印刷・共有用の固定形式
- **API連携**: 外部システムへのデータ提供
- **自動配信**: 定期・条件付きでの自動配信

## 8. レスポンシブデザイン

### 8.1 ブレークポイント
**モバイル**:
- 最大幅: 768px
- レイアウト: 縦並び・1列表示
- サイドバー: ハンバーガーメニュー

**タブレット**:
- 幅: 768px - 1024px
- レイアウト: 2列表示・サイドバー縮小
- カード: 2列表示

**デスクトップ**:
- 最小幅: 1024px
- レイアウト: 3-4列表示・サイドバー表示
- カード: 3-4列表示

### 8.2 モバイル最適化
**タッチ操作**:
- タップターゲット: 最小44px × 44px
- スワイプ: プラン間の移動・ステータス変更
- ピンチ: タイムラインのズーム・パン

**表示最適化**:
- フォントサイズ: 最小16px
- 余白: タッチ操作に適したサイズ
- スクロール: スムーズ・慣性スクロール

## 9. アクセシビリティ設計

### 9.1 キーボード操作
**ナビゲーション**:
- Tab順序: 論理的な順序
- ショートカット: Ctrl+A（承認）、Ctrl+R（却下）、Ctrl+M（修正要求）
- フォーカス管理: 視覚的フォーカス表示

**操作支援**:
- スキップリンク: メインコンテンツへの直接移動
- ランドマーク: 主要セクションの識別
- ページタイトル: 現在位置の明確化

### 9.2 スクリーンリーダー対応
**セマンティックHTML**:
- 見出し構造: h1-h6の適切な使用
- リスト: ul, ol, dlの適切な使用
- テーブル: th, captionの適切な使用

**ARIA属性**:
- ラベル: aria-label, aria-labelledby
- 説明: aria-describedby
- 状態: aria-expanded, aria-selected
- ライブリージョン: aria-live

### 9.3 視覚的アクセシビリティ
**コントラスト**:
- テキスト: WCAG AA準拠（4.5:1以上）
- ステータス表示: 十分なコントラスト
- フォーカス: 明確な視覚的表示

**色覚異常対応**:
- 色以外の情報: アイコン・テキスト・パターン
- ステータス表示: 複数の視覚的要素
- カスタマイズ: ユーザー設定での色変更

## 10. パフォーマンス設計

### 10.1 表示最適化
**レンダリング最適化**:
- 仮想化: 大量データの効率的表示
- 遅延読み込み: 必要時のみのデータ取得
- メモ化: 不要な再レンダリングの防止

**データ最適化**:
- ページネーション: 必要分のみのデータ取得
- フィルタリング: サーバーサイドでの絞り込み
- キャッシュ: 頻繁アクセスデータのキャッシュ

### 10.2 リアルタイム更新
**WebSocket連携**:
- ステータス変更: リアルタイムでの状態更新
- コメント追加: 即座のコメント表示
- 通知配信: リアルタイム通知

**オフライン対応**:
- データ同期: オフライン時のデータ保存・同期
- 操作キュー: オフライン時の操作記録・再実行
- 状態管理: オンライン・オフライン状態の適切な管理

## 11. 状態管理設計

### 11.1 グローバル状態
**プランデータ**:
- 一覧データ: 検索・フィルター結果
- 選択状態: 現在選択中のプラン
- 編集状態: 編集中のデータ・変更内容

**UI状態**:
- 表示モード: テーブル・カード・タイムライン
- フィルター設定: 現在適用中のフィルター
- 検索クエリ: 現在の検索条件

### 11.2 ローカル状態
**フォーム状態**:
- 入力値: 各フィールドの値
- バリデーション: エラー・警告状態
- 送信状態: 送信中・完了・エラー

**モーダル状態**:
- 表示状態: 開く・閉じる・アニメーション
- フォーカス管理: モーダル内のフォーカス
- キーボード操作: ESCキーでの閉じる

## 12. エラーハンドリング設計

### 12.1 ユーザーエラー
**入力エラー**:
- リアルタイムバリデーション: 入力中のエラー表示
- エラーメッセージ: 具体的な修正方法
- エラー表示: フィールド周辺・インライン表示

**操作エラー**:
- 確認ダイアログ: 重要な操作の確認
- エラー通知: 操作失敗の明確な通知
- 復旧方法: エラーからの復旧手順

### 12.2 システムエラー
**ネットワークエラー**:
- 接続エラー: ネットワーク問題の通知
- タイムアウト: 長時間の処理の通知
- 再試行: 自動・手動での再試行

**サーバーエラー**:
- エラーコード: 具体的なエラー内容
- サポート情報: 問い合わせ先・対処法
- ログ記録: エラーの詳細記録

## 13. セキュリティ設計

### 13.1 認証・認可
**アクセス制御**:
- ロールベース: 承認者・提案者・閲覧者
- 権限チェック: 操作前の権限確認
- セッション管理: セッションタイムアウト・自動ログアウト

**データ保護**:
- 暗号化: 機密データの暗号化
- マスキング: センシティブ情報の表示制限
- 監査ログ: 操作履歴の記録

### 13.2 承認セキュリティ
**承認プロセス**:
- 承認者認証: 承認者の本人確認
- 承認履歴: 承認・却下の完全な履歴記録
- 改ざん防止: 承認後のデータ改ざん防止
- 委任管理: 承認権限委任の適切な管理

## 14. テスト設計

### 14.1 単体テスト
**コンポーネントテスト**:
- レンダリング: 正しい表示・非表示
- インタラクション: クリック・入力・選択
- 状態管理: 状態の変化・更新

**ワークフローテスト**:
- 承認フロー: 各ステップの正常動作
- ステータス遷移: 適切な状態変更
- 権限チェック: 権限に応じた操作制限

### 14.2 統合テスト
**API連携**:
- データ取得: 一覧・詳細・検索
- データ更新: 承認・却下・修正要求
- エラーハンドリング: 異常系の処理

**ユーザーフロー**:
- 承認フロー: プラン提出から承認完了まで
- 却下フロー: 却下から再提出まで
- 修正要求フロー: 修正要求から再レビューまで

### 14.3 E2Eテスト
**ユーザーシナリオ**:
- 承認者: プランの承認・却下・修正要求
- 提案者: プランの提出・修正・再提出
- 管理者: 承認者割り当て・権限管理

## 15. 実装ガイドライン

### 15.1 技術スタック
**フロントエンド**:
- React 18: 最新のReact機能の活用
- TypeScript: 型安全性・開発効率の向上
- Tailwind CSS: 効率的なスタイリング
- Shadcn UI: 高品質なUIコンポーネント

**状態管理**:
- Zustand: 軽量・シンプルな状態管理
- React Query: サーバー状態の効率的管理
- React Hook Form: フォーム状態の管理

### 15.2 パフォーマンス要件
**表示速度**:
- 初期表示: 2秒以内
- 操作応答: 100ms以内
- アニメーション: 60fps維持

**データ処理**:
- 一覧表示: 1000件まで2秒以内
- 検索・フィルター: 500ms以内
- リアルタイム更新: 1秒以内

### 15.3 品質要件
**可用性**:
- 稼働率: 99.9%以上
- 障害復旧: 5分以内
- データ整合性: 100%保証

**セキュリティ**:
- 認証: 多要素認証対応
- 暗号化: AES-256以上
- 監査: 全操作のログ記録

## 16. まとめ

プラン承認画面の詳細設計書が完成しました。この設計書では以下の特徴を実現しています：

### 16.1 主要な特徴
- **包括的な承認ワークフロー**: 提出・承認・却下・修正要求の完全なフロー
- **透明性・追跡性**: 承認プロセスの完全な可視化・履歴管理
- **コラボレーション機能**: コメント・議論・合意形成の支援
- **分析・レポート**: 承認率・処理時間・傾向分析の提供
- **レスポンシブ対応**: 全デバイスでの最適な表示・操作

### 16.2 設計のポイント
- **ユーザビリティ**: 承認プロセスの直感性・効率性を重視
- **透明性**: 承認状況・進捗・履歴の完全な可視化
- **セキュリティ**: 適切な認証・認可・監査ログ
- **パフォーマンス**: 高速表示・操作応答・リアルタイム更新
- **拡張性**: 承認フロー・ルールの柔軟なカスタマイズ

### 16.3 次のステップ
この設計書を基に、以下の画面の設計書作成を進めます：
- Obsidian連携画面設計
- インタラクション設計
- レスポンシブデザイン
- アクセシビリティ設計
- パフォーマンス設計

各設計書においても、高度推論を活用し、包括的で実用的な設計を提供いたします。
